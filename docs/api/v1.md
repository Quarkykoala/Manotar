# API v1 Documentation

## Base URL

All API endpoints are prefixed with `/api/v1/`.

## Authentication

All endpoints except for `/api/v1/auth/login` require authentication via JWT token.
Include the token in the Authorization header: `Authorization: Bearer <token>`.

## Endpoints

### Authentication

#### `POST /api/v1/auth/login`

Authenticates a user and returns a JWT token.

**Request:**
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "email": "user@example.com",
      "role": "hr"
    }
  }
}
```

### Employees

#### `GET /api/v1/employees`

Returns a list of employees.

Query parameters:
- `department` (optional): Filter by department
- `location` (optional): Filter by location

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "name": "John Doe",
      "email": "john@example.com",
      "department": "Engineering",
      "location": "New York",
      "consent_given": true,
      "created_at": "2023-01-01T00:00:00Z",
      "updated_at": "2023-01-01T00:00:00Z"
    }
  ]
}
```

### Sentiment Analysis

#### `GET /api/v1/sentiment`

Returns sentiment analysis data.

Query parameters:
- `start_date` (optional): Filter by start date (YYYY-MM-DD)
- `end_date` (optional): Filter by end date (YYYY-MM-DD)
- `department` (optional): Filter by department
- `location` (optional): Filter by location

**Response:**
```json
{
  "success": true,
  "data": {
    "average_score": 0.75,
    "trend": [
      {
        "date": "2023-01-01",
        "score": 0.8
      },
      {
        "date": "2023-01-02",
        "score": 0.7
      }
    ],
    "by_department": [
      {
        "department": "Engineering",
        "score": 0.8
      },
      {
        "department": "Marketing",
        "score": 0.7
      }
    ]
  }
}
```

### WhatsApp Integration

#### `POST /api/v1/whatsapp/webhook`

Webhook for incoming WhatsApp messages.

**Request:**
```json
{
  "From": "whatsapp:+1234567890",
  "Body": "Hello, how are you today?"
}
```

**Response:**
```json
{
  "success": true
}
```

### Analytics

#### `GET /api/v1/analytics/dashboard`

Returns dashboard analytics data.

Query parameters:
- `start_date` (optional): Filter by start date (YYYY-MM-DD)
- `end_date` (optional): Filter by end date (YYYY-MM-DD)

**Response:**
```json
{
  "success": true,
  "data": {
    "participation_rate": 0.85,
    "sentiment_trend": [...],
    "keywords": [
      {
        "word": "stress",
        "count": 45
      },
      {
        "word": "happy",
        "count": 32
      }
    ]
  }
}
``` 